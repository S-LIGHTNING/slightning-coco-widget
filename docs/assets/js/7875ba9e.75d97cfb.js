"use strict";(self.webpackChunkslightning_coco_widget_document=self.webpackChunkslightning_coco_widget_document||[]).push([[31],{7009:(n,r,e)=>{e.r(r),e.d(r,{assets:()=>l,contentTitle:()=>c,default:()=>d,frontMatter:()=>i,metadata:()=>o,toc:()=>a});const o=JSON.parse('{"id":"example/promise","title":"\u627f\u8bfa","description":"\u63a7\u4ef6\u4ee3\u7801","source":"@site/docs/example/promise.md","sourceDirName":"example","slug":"/example/promise","permalink":"/slightning-coco-widget/docs/example/promise","draft":false,"unlisted":false,"editUrl":"https://github.com/S-LIGHTNING/slightning-coco-widget/edit/main/\u6587\u6863/docs/example/promise.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"exampleSidebar"}');var t=e(4848),s=e(8453);const i={sidebar_position:1},c="\u627f\u8bfa",l={},a=[{value:"\u63a7\u4ef6\u4ee3\u7801",id:"\u63a7\u4ef6\u4ee3\u7801",level:2},{value:"\u751f\u6210\u7684\u79ef\u6728",id:"\u751f\u6210\u7684\u79ef\u6728",level:2},{value:"CoCo",id:"coco",level:3},{value:"Creation Project",id:"creation-project",level:3}];function p(n){const r={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",p:"p",pre:"pre",...(0,s.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.header,{children:(0,t.jsx)(r.h1,{id:"\u627f\u8bfa",children:"\u627f\u8bfa"})}),"\n",(0,t.jsx)(r.h2,{id:"\u63a7\u4ef6\u4ee3\u7801",children:"\u63a7\u4ef6\u4ee3\u7801"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-typescript",children:'import { addCheck, addThisForMethods, AnyType, Color, exportWidget, FunctionType, generateMethodForFunctions, getSuperWidget, InstanceType, MethodBlockParam, ObjectType, transformIcons, transformIconsExceptWidgetIcon, transformMethodsCallbackFunctionsToCodeBlocks, transformMethodsCallbackFunctionsToEvents, Types } from "slightning-coco-widget"\r\n\r\nconst types: Types = {\r\n    type: "SLIGHTNING_COCO_WIDGET_EXAMPLE_PROMISE_WIDGET",\r\n    info: {\r\n        title: "\u627f\u8bfa",\r\n        icon: "icon-widget-switch",\r\n        category: "\u63a7\u5236",\r\n    },\r\n    options: {\r\n        visible: false,\r\n        global: true\r\n    },\r\n    properties: [],\r\n    methods: [\r\n        {\r\n            blockOptions: {\r\n                color: Color.CYAN\r\n            },\r\n            contents: [\r\n                {\r\n                    key: "newPromise",\r\n                    label: "\u521b\u5efa\u627f\u8bfa",\r\n                    block: [\r\n                        MethodBlockParam.METHOD, {\r\n                            key: "callback",\r\n                            label: "\u56de\u8c03",\r\n                            type: new FunctionType({\r\n                                block: [\r\n                                    {\r\n                                        key: "resolve",\r\n                                        label: "\u89e3\u51b3",\r\n                                        type: new FunctionType({\r\n                                            block: [\r\n                                                "\u7ed3\u679c", {\r\n                                                    key: "value",\r\n                                                    label: "\u7ed3\u679c",\r\n                                                    type: new AnyType({\r\n                                                        defaultValue: "\u7ed3\u679c"\r\n                                                    })\r\n                                                }\r\n                                            ]\r\n                                        })\r\n                                    }, {\r\n                                        key: "reject",\r\n                                        label: "\u62d2\u7edd",\r\n                                        type: new FunctionType({\r\n                                            block: [\r\n                                                "\u539f\u56e0", {\r\n                                                    key: "reason",\r\n                                                    label: "\u539f\u56e0",\r\n                                                    type: new AnyType({\r\n                                                        defaultValue: "\u539f\u56e0"\r\n                                                    })\r\n                                                }\r\n                                            ]\r\n                                        })\r\n                                    }\r\n                                ]\r\n                            })\r\n                        }\r\n                    ],\r\n                    returns: new ObjectType({\r\n                        propertiesType: {\r\n                            promise: new InstanceType({\r\n                                theClass: Promise\r\n                            })\r\n                        }\r\n                    })\r\n                }, {\r\n                    key: "await",\r\n                    label: "\u7b49\u5f85",\r\n                    block: [\r\n                        MethodBlockParam.METHOD, {\r\n                            key: "promise",\r\n                            label: "\u627f\u8bfa",\r\n                            type: new ObjectType<{\r\n                                promise: Promise<unknown>\r\n                            }>({\r\n                                propertiesType: {\r\n                                    promise: new InstanceType({\r\n                                        theClass: Promise\r\n                                    })\r\n                                },\r\n                                defaultValue: "\u627f\u8bfa"\r\n                            })\r\n                        }\r\n                    ]\r\n                }, {\r\n                    key: "awaitResult",\r\n                    label: "\u7b49\u5f85\u7ed3\u679c",\r\n                    block: [\r\n                        MethodBlockParam.METHOD, {\r\n                            key: "promise",\r\n                            label: "\u627f\u8bfa",\r\n                            type: new ObjectType<{\r\n                                promise: Promise<unknown>\r\n                            }>({\r\n                                propertiesType: {\r\n                                    promise: new InstanceType({\r\n                                        theClass: Promise\r\n                                    })\r\n                                },\r\n                                defaultValue: "\u627f\u8bfa"\r\n                            })\r\n                        }\r\n                    ],\r\n                    returns: new AnyType()\r\n                }, {\r\n                    key: "then",\r\n                    label: "\u7136\u540e",\r\n                    block: [\r\n                        {\r\n                            key: "promise",\r\n                            label: "\u627f\u8bfa",\r\n                            type: new ObjectType<{\r\n                                promise: Promise<unknown>\r\n                            }>({\r\n                                propertiesType: {\r\n                                    promise: new InstanceType({\r\n                                        theClass: Promise\r\n                                    })\r\n                                },\r\n                                defaultValue: "\u627f\u8bfa"\r\n                            })\r\n                        }, MethodBlockParam.METHOD, {\r\n                            key: "callback",\r\n                            label: "\u56de\u8c03",\r\n                            type: new FunctionType({\r\n                                block: [\r\n                                    {\r\n                                        key: "value",\r\n                                        label: "\u7ed3\u679c",\r\n                                        type: new AnyType()\r\n                                    }\r\n                                ]\r\n                            })\r\n                        }\r\n                    ]\r\n                }, {\r\n                    key: "catch",\r\n                    label: "\u6355\u83b7",\r\n                    block: [\r\n                        {\r\n                            key: "promise",\r\n                            label: "\u627f\u8bfa",\r\n                            type: new ObjectType<{\r\n                                promise: Promise<unknown>\r\n                            }>({\r\n                                propertiesType: {\r\n                                    promise: new InstanceType({\r\n                                        theClass: Promise\r\n                                    })\r\n                                },\r\n                                defaultValue: "\u627f\u8bfa"\r\n                            })\r\n                        }, MethodBlockParam.METHOD, {\r\n                            key: "callback",\r\n                            label: "\u56de\u8c03",\r\n                            type: new FunctionType({\r\n                                block: [\r\n                                    {\r\n                                        key: "reason",\r\n                                        label: "\u539f\u56e0",\r\n                                        type: new AnyType()\r\n                                    }\r\n                                ]\r\n                            })\r\n                        }\r\n                    ]\r\n                }\r\n            ]\r\n        }\r\n    ],\r\n    events: []\r\n}\r\n\r\nclass TestBaseWidget extends getSuperWidget(types) {\r\n\r\n    public constructor(props: unknown) {\r\n        super(props)\r\n    }\r\n\r\n    public newPromise(\r\n        callback: (\r\n            resolve: (value: unknown) => void,\r\n            reject: (reason: unknown) => void\r\n        ) => void\r\n    ): { promise: Promise<unknown> } {\r\n        return { promise: new Promise(callback) }\r\n    }\r\n\r\n    public await(promise: { promise: Promise<unknown> }): Promise<unknown> {\r\n        return promise.promise\r\n    }\r\n\r\n    public awaitResult(promise: { promise: Promise<unknown> }): Promise<unknown> {\r\n        return promise.promise\r\n    }\r\n\r\n    public then(\r\n        promise: { promise: Promise<unknown> },\r\n        callback: (value: unknown) => void\r\n    ): Promise<unknown> {\r\n        return promise.promise.then(callback)\r\n    }\r\n\r\n    public catch(\r\n        promise: { promise: Promise<unknown> },\r\n        callback: (reason: unknown) => void\r\n    ): Promise<unknown> {\r\n        return promise.promise.catch(callback)\r\n    }\r\n}\r\n\r\nexportWidget(types, TestBaseWidget, {\r\n    decorators: [\r\n        generateMethodForFunctions\r\n    ],\r\n    CoCo: {\r\n        decorators: [\r\n            transformMethodsCallbackFunctionsToEvents,\r\n            addThisForMethods,\r\n            addCheck,\r\n            transformIconsExceptWidgetIcon\r\n        ]\r\n    },\r\n    CreationProject: {\r\n        decorators: [\r\n            transformMethodsCallbackFunctionsToCodeBlocks,\r\n            addThisForMethods,\r\n            addCheck,\r\n            transformIcons\r\n        ]\r\n    }\r\n})\n'})}),"\n",(0,t.jsx)(r.h2,{id:"\u751f\u6210\u7684\u79ef\u6728",children:"\u751f\u6210\u7684\u79ef\u6728"}),"\n",(0,t.jsx)(r.h3,{id:"coco",children:"CoCo"}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.img,{src:"https://s2.loli.net/2025/05/04/C6q1AyiKFcJQwrN.jpg",alt:"CoCo \u751f\u6210\u7684\u79ef\u6728.png"})}),"\n",(0,t.jsx)(r.h3,{id:"creation-project",children:"Creation Project"}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.img,{src:"https://s2.loli.net/2025/05/04/WfqGQABScM42Ed9.jpg",alt:"Creation Project \u751f\u6210\u7684\u79ef\u6728.png"})})]})}function d(n={}){const{wrapper:r}={...(0,s.R)(),...n.components};return r?(0,t.jsx)(r,{...n,children:(0,t.jsx)(p,{...n})}):p(n)}},8453:(n,r,e)=>{e.d(r,{R:()=>i,x:()=>c});var o=e(6540);const t={},s=o.createContext(t);function i(n){const r=o.useContext(s);return o.useMemo((function(){return"function"==typeof n?n(r):{...r,...n}}),[r,n])}function c(n){let r;return r=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:i(n.components),o.createElement(s.Provider,{value:r},n.children)}}}]);